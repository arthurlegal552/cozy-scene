<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>lo-fi scene</title>
  <style>
    body { margin: 0; overflow: hidden; }
  </style>
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.150.1/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.150.1/examples/jsm/"
      }
    }
  </script>
</head>
<body>
  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    renderer.setClearColor(0xFEFEFE);

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(
      45,
      window.innerWidth / window.innerHeight,
      0.1,
      1000
    );

    const orbit = new OrbitControls(camera, renderer.domElement);
    camera.position.set(6, 8, 14);
    orbit.update();

    scene.add(new THREE.GridHelper(12, 12));
    scene.add(new THREE.AxesHelper(4));

    const aLight = new THREE.AmbientLight(0xffffff, 1);
    scene.add(aLight);

    const dLight = new THREE.DirectionalLight(0xffffff, 10);
    dLight.position.set(4, 10, 3);
    scene.add(dLight);

    const loader = new GLTFLoader();
    loader.load('assets/smol_ame_in_an_upcycled_terrarium_hololiveen.glb', function (gltf) {
      const model = gltf.scene;
      scene.add(model);
    }, undefined, function (error) {
      console.error('Erro ao carregar o modelo:', error);
    });

    loader.load('assets/smol_ame_in_an_upcycled_terrarium_hololiveen.glb', function(glb) {
    const model = glb.scene;
    scene.add(model);
}, function (xhr) {
    console.log((xhr.loaded / xhr.total * 100) + '% loaded');
});

let mixer;

mixer = new THREE.AnimationMixer(model);

const clips = gltf.animations;

mixer = new THREE.AnimationMixer(model);
const clip = 
THREE.AnimationClip.findByName(clips, 'Animation');

const action = mixer.clipAction(clip)
action.play();

const clock = new THREE.Clock();
    function animate() {
      if (mixer) {
        const delta = clock.getDelta();
        mixer.update(delta)
      }
      orbit.update();
      renderer.render(scene, camera);
    }

    renderer.setAnimationLoop(animate);

    window.addEventListener('keydown', function(e) {
      if (e.code === 'Space')
      action.paused = !action.paused;
    })

    action.loop = THREE.LoopRepeat;

    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
